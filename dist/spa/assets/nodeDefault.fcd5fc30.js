var ue=Object.defineProperty,pe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var X=(s,h,v)=>h in s?ue(s,h,{enumerable:!0,configurable:!0,writable:!0,value:v}):s[h]=v,R=(s,h)=>{for(var v in h||(h={}))fe.call(h,v)&&X(s,v,h[v]);if(K)for(var v of K(h))ge.call(h,v)&&X(s,v,h[v]);return s},j=(s,h)=>pe(s,me(h));import{b as Y,Q as ve,a as J,c as Z,_ as he}from"./tyeng.a690c00e.js";import{h as k,a as W,u as ne,f as Ce,V as be,g as ie,i as ye,R as E,d as w,a4 as re,e as _e,a3 as ke,j as de,a9 as P,aa as Ve,ab as ee,o as Me,t as Se,w as we,r as xe,q as qe,s as L,y as c,B as u,z as x,ae as De,H as q,I as oe,E as i,C as Ie,F as U,D as _,G as V,M as N,A as D,Q as T,af as $,ai as A,ag as B,ah as H,v as te,x as ae,P as Ne,L as Oe}from"./index.9b424d6f.js";import{Q as se}from"./QCardActions.b3c92032.js";import{o as Fe,u as Re,a as Qe,b as Le,c as Te,Q as je}from"./QCheckbox.909c7ef5.js";import{Q as z}from"./QInput.18331260.js";import{Q as Ae,a as G,C as Q}from"./ClosePopup.eb9ca650.js";const Be=k("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24","aria-hidden":"true"},[k("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),k("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]);var He=W({name:"QRadio",props:j(R(R(R({},ne),Ce),be),{modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]}),emits:["update:modelValue"],setup(s,{slots:h,emit:v}){const{proxy:b}=de(),C=ie(s,b.$q),I=ye(s,Fe),o=E(null),{refocusTargetEl:O,refocusTarget:a}=Re(s,o),t=w(()=>P(s.modelValue)===P(s.val)),e=w(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(s.disable===!0?" disabled":"")+(C.value===!0?" q-radio--dark":"")+(s.dense===!0?" q-radio--dense":"")+(s.leftLabel===!0?" reverse":"")),d=w(()=>{const l=s.color!==void 0&&(s.keepColor===!0||t.value===!0)?` text-${s.color}`:"";return`q-radio__inner relative-position q-radio__inner--${t.value===!0?"truthy":"falsy"}${l}`}),n=w(()=>(t.value===!0?s.checkedIcon:s.uncheckedIcon)||null),r=w(()=>s.disable===!0?-1:s.tabindex||0),m=w(()=>{const l={type:"radio"};return s.name!==void 0&&Object.assign(l,{"^checked":t.value===!0?"checked":void 0,name:s.name,value:s.val}),l}),F=Ve(m);function M(l){l!==void 0&&(ee(l),a(l)),s.disable!==!0&&t.value!==!0&&v("update:modelValue",s.val,l)}function S(l){(l.keyCode===13||l.keyCode===32)&&ee(l)}function g(l){(l.keyCode===13||l.keyCode===32)&&M(l)}return Object.assign(b,{set:M}),()=>{const l=n.value!==null?[k("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[k(re,{class:"q-radio__icon",name:n.value})])]:[Be];s.disable!==!0&&F(l,"unshift"," q-radio__native q-ma-none q-pa-none");const p=[k("div",{class:d.value,style:I.value},l)];O.value!==null&&p.push(O.value);const f=s.label!==void 0?_e(h.default,[s.label]):ke(h.default);return f!==void 0&&p.push(k("div",{class:"q-radio__label q-anchor--skip"},f)),k("div",{ref:o,class:e.value,tabindex:r.value,role:"radio","aria-label":s.label,"aria-checked":t.value===!0?"true":"false","aria-disabled":s.disable===!0?"true":void 0,onClick:M,onKeydown:S,onKeyup:g},p)}}}),Ee=W({name:"QToggle",props:j(R({},Qe),{icon:String,iconColor:String}),emits:Le,setup(s){function h(v,b){const C=w(()=>(v.value===!0?s.checkedIcon:b.value===!0?s.indeterminateIcon:s.uncheckedIcon)||s.icon),I=w(()=>v.value===!0?s.iconColor:null);return()=>[k("div",{class:"q-toggle__track"}),k("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},C.value!==void 0?[k(re,{name:C.value,color:I.value})]:void 0)]}return Te("toggle",h)}});const ce={radio:He,checkbox:je,toggle:Ee},Je=Object.keys(ce);var le=W({name:"QOptionGroup",props:j(R({},ne),{modelValue:{required:!0},options:{type:Array,validator:s=>s.every(h=>"value"in h&&"label"in h)},name:String,type:{default:"radio",validator:s=>Je.includes(s)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean}),emits:["update:modelValue"],setup(s,{emit:h,slots:v}){const{proxy:{$q:b}}=de(),C=Array.isArray(s.modelValue);s.type==="radio"?C===!0&&console.error("q-option-group: model should not be array"):C===!1&&console.error("q-option-group: model should be array in your case");const I=ie(s,b),o=w(()=>ce[s.type]),O=w(()=>"q-option-group q-gutter-x-sm"+(s.inline===!0?" q-option-group--inline":"")),a=w(()=>{const e={};return s.type==="radio"&&(e.role="radiogroup",s.disable===!0&&(e["aria-disabled"]="true")),e});function t(e){h("update:modelValue",e)}return()=>k("div",R({class:O.value},a.value),s.options.map((e,d)=>{const n=v["label-"+d]!==void 0?()=>v["label-"+d](e):v.label!==void 0?()=>v.label(e):void 0;return k("div",[k(o.value,{modelValue:s.modelValue,val:e.value,name:e.name===void 0?s.name:e.name,disable:s.disable||e.disable,label:n===void 0?e.label:null,leftLabel:e.leftLabel===void 0?s.leftLabel:e.leftLabel,color:e.color===void 0?s.color:e.color,checkedIcon:e.checkedIcon,uncheckedIcon:e.uncheckedIcon,dark:e.dark||I.value,size:e.size===void 0?s.size:e.size,dense:s.dense,keepColor:e.keepColor===void 0?s.keepColor:e.keepColor,"onUpdate:modelValue":t},n)])}))}});const Ue={class:"q-ml-sm"},$e=i("div",{class:"col text-h4"},"\uB808\uC9C0\uC2A4\uD130\uC2DC\uBBAC\uB808\uC774\uD130",-1),ze={class:"q-pa-md q-gutter-sm row"},Ge={class:"col-3 text-right"},We=i("div",{class:"col-1"},null,-1),Ke={class:"col text-center"},Xe={class:"q-pa-xs q-gutter-sm row"},Ye=i("div",{class:"col-3 text-right"},"\uC2AC\uB808\uC774\uBE0C \uC8FC\uC18C(Dec)",-1),Ze=i("div",{class:"col-1"},null,-1),Pe={class:"col"},eo={class:"q-pa-xs q-gutter-sm row"},oo=i("div",{class:"col-3 text-right"},"\uAE30\uB2A5 \uCF54\uB4DC(Dec)",-1),to=i("div",{class:"col-1"},null,-1),ao={class:"col"},so=N("\uB808\uC9C0\uC2A4\uD130\uC77D\uAE30(03)"),lo=N("\uB2E8\uC77C\uB808\uC9C0\uC2A4\uD130\uC4F0\uAE30(06)"),no=N("\uB2E4\uC911\uB808\uC9C0\uC2A4\uD130\uC4F0\uAE30(16)"),io={class:"col"},ro={class:"col"},co={class:"q-pa-xs q-gutter-sm row"},uo=i("div",{class:"col-3 text-right"},"\uB808\uC9C0\uC2A4\uD130 \uC8FC\uC18C(Dec)",-1),po=i("div",{class:"col-1"},null,-1),mo={class:"col"},fo={class:"q-pa-xs q-gutter-sm row"},go={class:"col-3 text-right"},vo=i("div",{class:"col-1"},null,-1),ho={class:"col"},Co=i("p",null,"Multi Word Write \uC0AC\uC6A9\uC2DC\uC5D4 Value\uAC12\uC5D0 \uC27C\uD45C\uB85C \uAC12\uC744 \uB098\uB204\uC5B4 \uC785\uB825\uD560\uAC83. ex) \uC5F0\uC18D\uD558\uB294 \uBA54\uBAA8\uB9AC \uC8FC\uC18C\uC5D0 1,2,3\uC744 \uB123\uC744\uACBD\uC6B0 Value\uAC12\uC5D0 1,2,3\uC774\uB7F0 \uD615\uD0DC\uB85C \uC785\uB825\uD568",-1),bo={class:"col text-right justify-center"},yo={class:"q-pa-md"},_o=i("thead",null,[i("tr",null,[i("th",{scope:"col"},"\uB808\uC9C0\uC2A4\uD130\uC8FC\uC18C"),i("th",{scope:"col"},"HEX\uAC12"),i("th",{scope:"col"},"word\uAC12"),i("th",{scope:"col"},"\uB808\uC9C0\uC2A4\uD130\uAC1C\uC218"),i("th",{scope:"col"},"\uC124\uBA85"),i("th")])],-1),ko={scope:"row",width:"120px"},Vo={width:"200px"},Mo={width:"200px"},So={width:"200px"},wo={width:"500px"},xo={key:0},qo=i("img",{src:he},null,-1),Do=N("\uD2F0\uC640\uC774\uC774\uC5D4\uC9C0 \uC2A4\uB9C8\uD2B8 \uC81C\uC5B4 "),To={name:"nodeDefault",setup(s){const h=E(6),v=E("read");let b=E({alert:!1,icon:"delete",label:"",text:"",yesNo:!0,onClick:{},data:null});const C=Me("smartFarm"),I=Se(C,"msg");we(I,a=>{if(a.topic.startsWith("nodeDefault"))var t=a.topic.split("/")[1];else return;switch(String(t)){case"deviceCodes":console.log(a),a.payload.length===0?O("./deviceCodes.json",function(g){const l=JSON.parse(g);l.forEach((p,f)=>{var y={collection:"deviceCodes",operation:"insertOne",payload:p};y.topic="nodeDefault/insertDeviceCode",C.send(y),f===l.length-1&&C.send({topic:"nodeDefault/defaultMaps",collection:"defaultMaps",operation:"find.toArray"})})}):(o.deviceCodes=JSON.parse(JSON.stringify(a.payload)),C.send({topic:"nodeDefault/defaultMaps",collection:"defaultMaps",operation:"find.toArray"}));break;case"defaultMaps":a.payload.length===0?O("./defaultMaps.json",function(g){const l=JSON.parse(g);l.forEach((p,f)=>{var y={collection:"defaultMaps",operation:"insertOne",payload:p};y.topic="nodeDefault/insertMap",C.send(y),f===l.length-1&&C.send({topic:"nodeDefault/registerMaps",collection:"registerMaps",operation:"find.toArray"})}),console.log(r)}):C.send({topic:"nodeDefault/registerMaps",collection:"registerMaps",operation:"find.toArray"});case"registerMaps":a.payload.forEach(g=>{o.registerMaps[g._id]={},o.registerMaps[g._id]=JSON.parse(JSON.stringify(g)),a.topic==="registerMaps"?o.registerMaps[g._id].collection="registerMaps":o.registerMaps[g._id].collection="defaultMaps"}),t==="registerMaps"&&C.send({topic:"nodeDefault/deviceNodes",collection:"deviceNodes",operation:"find.toArray"});break;case"requestModbus":var e,d=(g,l,p,f)=>{if(l==="1/2"){if(p=="HighChar")var y=String.fromCharCode(f>>8&255);else if(p=="LowChar")var y=String.fromCharCode(f&255);else if(p=="High"){var y=f>>8&255;n===906&&(y="0b"+y.toString(2))}else if(p=="Low")var y=f&255}else if(p===void 0)var y=f;else if(p==="Int")var y=o.byteToVal(f).getInt32(0);else var y=o.byteToVal(f).getFloat32(0).toFixed(2);o.mapComponent.resultValues.push(o.pushData(n,g,f,y,l))};if(console.log("msg",a),o.mapComponent.resultValues=[],o.readResultShow=!0,a.modbusRequest!==void 0){console.log("modbusRequest",a.modbusRequest);var n=a.modbusRequest.address,r=JSON.parse(JSON.stringify(a.payload.data));for(console.log("data",r);n<a.modbusRequest.address+a.modbusRequest.quantity;){var e=n-a.modbusRequest.address;if(o.mapComponent.arrayCommonMap.map(l=>l.address).includes(n)){var m=o.mapComponent.arrayCommonMap.findIndex(l=>l.address==n);if(o.mapComponent.arrayCommonMap[m].registerCount>1){console.log("registerCount",o.mapComponent.arrayCommonMap[m].registerCount),console.log("addressIndex",e);var F=[];F[0]=r[e],F[1]=r[e+1],console.log(F),d(o.mapComponent.arrayCommonMap[m].description,o.mapComponent.arrayCommonMap[m].registerCount,o.mapComponent.arrayCommonMap[m].to,JSON.parse(JSON.stringify(F))),n+=o.mapComponent.arrayCommonMap[m].registerCount}else o.mapComponent.arrayCommonMap[m].to==="High"||o.mapComponent.arrayCommonMap[m].to==="HighChar"?(d(o.mapComponent.arrayCommonMap[m].description,o.mapComponent.arrayCommonMap[m].registerCount,o.mapComponent.arrayCommonMap[m].to,r[e]),d(o.mapComponent.arrayCommonMap[m+1].description,o.mapComponent.arrayCommonMap[m+1].registerCount,o.mapComponent.arrayCommonMap[m+1].to,r[e]),n++):(console.log(F),d(o.mapComponent.arrayCommonMap[m].description,o.mapComponent.arrayCommonMap[m].registerCount,o.mapComponent.arrayCommonMap[m].to,r[e]),n++)}else if(n<=200){if(console.log("address",n,"nodeDefault.deviceCodes",o.deviceCodes),n>100&&o.mapComponent.devices[e]!==void 0){console.log("data[",e,"]",r[e]);var m=o.deviceCodes.map(p=>p._id).indexOf(r[e]);console.log("nodeDefault.deviceCodes[",m,"]",o.deviceCodes[m]),r[e]>0?d(o.deviceCodes[m].device.Name,1,void 0,r[e]):d("\uC7A5\uCE58\uC5C6\uC74C",1,void 0,r[e]),(o.registerMap._id==="tyIntegratedNodeBase"||o.registerMap._id==="tyActuatorNodeBase"||o.registerMap._id==="tySensorNodeBase")&&console.log("data[",e,"]",r[e])}n++}else if(n<900)if(n===o.registerMap.CommSpec[Object.keys(o.registerMap.CommSpec)[0]].read["starting-register"])console.log(o.registerMap.CommSpec[Object.keys(o.registerMap.CommSpec)[0]].read.items),o.registerMap.CommSpec[Object.keys(o.registerMap.CommSpec)[0]].read.items.forEach(l=>{d(o.registerMap.name,o.checkLength(l),"Int",r[e]),n++});else if(n===o.registerMap.CommSpec[Object.keys(o.registerMap.CommSpec)[0]].write["starting-register"])o.registerMap.CommSpec[Object.keys(o.registerMap.CommSpec)[0]].write.items.forEach(l=>{d(o.registerMap.name,o.checkLength(l),"Int",r[e]),n++});else if(o.registerMap.Devices.map(l=>l.CommSpec[Object.keys(l.CommSpec)[0]].read["starting-register"]).includes(n)){var m=o.registerMap.Devices.map(f=>f.CommSpec[Object.keys(f.CommSpec)[0]].read["starting-register"]).indexOf(n),S=o.registerMap.Devices[m].CommSpec[Object.keys(o.registerMap.Devices[m].CommSpec)[0]].read.items;S.forEach((f,y)=>{e=n-a.modbusRequest.address,f==="value"?(console.log(n,[r[e],r[e+1]]),d(o.registerMap.Devices[m].Name,o.checkLength(f),"Float",[r[e],r[e+1]])):o.checkLength(f)==1?(console.log(n,r[e]),d(f,o.checkLength(f),void 0,r[e])):(console.log(n,r[e]),d(f,o.checkLength(f),"Int",r[e])),n+=o.checkLength(f)})}else n++;else if(n<1e3){const l=parseInt((n-910)/10),p=n-910-l*10;p==0?d("\uC13C\uC11C \uCC44\uB110 "+l+" \uC81C\uD488\uCF54\uB4DC",1,void 0,r[e]):p==1?d("\uC13C\uC11C\uCC44\uB110 "+l+" K\uC0C1\uC218",2,"Float",[r[e],r[e+1]]):p==2||p==3&&d("\uC13C\uC11C\uCC44\uB110 "+l+" P\uC0C1\uC218",2,"Float",[r[e],r[e+1]]),n++}else if(n<=1100){const l=parseInt((n-1e3)/10),p=n-1e3-l*10;console.log("data[",e,"]",r[e]),p==0?d("\uAC1C\uD3D0\uAE30 \uCC44\uB110 "+l+" \uC81C\uD488\uCF54\uB4DC",1,void 0,r[e]):p==1?d("\uAC1C\uD3D0\uAE30 \uCC44\uB110 "+l+" \uC5EC\uB294\uC2DC\uAC04",1,void 0,r[e]):p==2&&d("\uAC1C\uD3D0\uAE30 \uCC44\uB110 "+l+" \uB2EB\uB294\uC2DC\uAC04",1,void 0,r[e]),n++}else if(n<=1200){const l=parseInt((n-1100)/10),p=n-1100-l*10;console.log("data[",e,"]",r[e]),p==0?d("\uC2A4\uC704\uCE58 \uCC44\uB110 "+l+" \uC81C\uD488\uCF54\uB4DC",1,void 0,r[e]):p==1&&d("\uC2A4\uC704\uCE58 \uCC44\uB110 "+l+" \uAC1C\uBC29\uAC15\uB3C4",1,void 0,r[e]),n++}else if(n>=1301&&n<=1330){const l=n-1301;console.log("data[",e,"]",r[e]),d("\uC7A5\uCE58"+l+" \uCC44\uB110\uBC88\uD638","1/2","High",r[e]),d("\uC7A5\uCE58"+l+" \uCF54\uB4DC","1/2","Low",r[e]),n++}else n++}}break;case"readDeviceRegisterItemValues":var M=0;console.log(a);var S=JSON.parse(JSON.stringify(o.mapComponent.devices[a.index].commSpec.read.items).reduce((g,l)=>(g[l]=0,g),{}));o.mapComponent.devices[a.index].commSpec.read.items.forEach((g,l)=>{if(o.checkLength(g)===1)S[g]={},S[g].hex=o.valueToHex(a.payload.data[M]),S[g].value=a.payload.data[M],M+=1;else{S[g]={},S[g].hex="0x"+o.valueToHex(a.payload.data[M+1])+o.valueToHex(a.payload.data[M]);var p=o.byteToVal(a.payload.data.slice(M,M+2));g==="value"?S[g].value=p.getFloat32(0).toFixed(2)+""+o.mapComponent.devices[a.index].valueUnit:S[g].value=p.getInt32(0),M+=2}}),o.mapComponent.readResult[a.index]=JSON.stringify(S,null,2),o.mapComponent.readResultShow[a.index]=!0;break}});const o=xe({readResultShow:!1,command:v.value,readWrite:[{text:"\uB178\uB4DC\uC77D\uAE30",value:"read"},{text:"\uB178\uB4DC\uC4F0\uAE30",value:"write"}],deviceType:[{text:"\uC6D0\uC608\uC13C\uC11C",value:"defaultSensorNode"},{text:"\uCD95\uC0AC\uC13C\uC11C",value:"defaultLivestockSensorNode"},{text:"\uAD6C\uB3D9\uAE30",value:"defaultActuatorNode"}],selectedDeviceMap:"defaultSensorNode",registerMap:{},mapComponent:{arrayCommonMap:[{address:1,description:"\uAE30\uAD00\uCF54\uB4DC",registerCount:1},{address:2,description:"\uD68C\uC0AC\uCF54\uB4DC",registerCount:1},{address:3,description:"\uC81C\uD488\uD0C0\uC785",registerCount:1},{address:4,description:"\uC81C\uD488\uCF54\uB4DC",registerCount:1},{address:5,description:"\uD504\uB85C\uD1A0\uCF5C\uBC84\uC804",registerCount:1},{address:6,description:"\uCC44\uB110\uC218",registerCount:1},{address:7,description:"\uC2DC\uB9AC\uC5BC\uBC88\uD638",registerCount:2,to:"Int"},{address:197,description:"\uB0B4\uBD80\uC2B5\uB3C4",registerCount:2,to:"Float"},{address:199,description:"\uB0B4\uBD80\uC628\uB3C4",registerCount:2,to:"Float"},{address:201,description:"OPID",registerCount:1},{address:202,description:"\uB178\uB4DC\uC0C1\uD0DC",registerCount:1},{address:401,description:"\uB3D9\uC791",registerCount:1},{address:402,description:"OPID",registerCount:1},{address:403,description:"\uC81C\uC5B4\uAD8C",registerCount:1},{address:900,description:"\uD2F0\uC640\uC774 \uB178\uB4DC \uD655\uC778",registerCount:"1/2",to:"HighChar"},{address:900,description:"\uD2F0\uC640\uC774 \uB178\uB4DC \uD655\uC778",registerCount:"1/2",to:"LowChar"},{address:901,description:"\uAE30\uAD00\uCF54\uB4DC",registerCount:1},{address:902,description:"\uD68C\uC0AC\uCF54\uB4DC",registerCount:1},{address:903,description:"\uB178\uB4DC\uD0C0\uC785",registerCount:1},{address:904,description:"\uC81C\uD488\uCF54\uB4DC",registerCount:1},{address:905,description:"\uD504\uB85C\uD1A0\uCF5C\uBC84\uC804",registerCount:1},{address:906,description:"\uC608\uBE44",registerCount:"1/2",to:"High"},{address:906,description:"\uC2AC\uB808\uC774\uBE0C\uC8FC\uC18C",registerCount:"1/2",to:"Low"},{address:907,description:"\uB178\uB4DC\uC2DC\uB9AC\uC5BC\uBC88\uD638",registerCount:2,to:"Int"}],devices:[],resultValues:[],readResult:[],readResultShow:[],nodeType:1},modbusVariables:{_id:176,functionCode:h.value,registerAddress:1,registerValues:8,label:"\uB808\uC9C0\uC2A4\uD130\uC77D\uAE30(03)",placeHolder:"ex) 8",actionMenu:"\uB808\uC9C0\uC2A4\uD130\uAC1C\uC218(Dec)",action:"\uC77D\uAE30"},registerMaps:[],deviceCodes:[],countQuantity:a=>{var t=0;return a.forEach(e=>{switch(String(e)){case"value":case"state-hold-time":case"remain-time":case"hold-time":case"time":case"EC":case"pH":case"epoch":case"vfloat":t+=2;break;default:t+=1}}),t},selectDeviceMap:function(a){this.selectedDeviceMap=a,console.log("this.registerMaps",this.registerMaps),this.registerMap=JSON.parse(JSON.stringify(this.registerMaps[a])),console.log("this.registerMap",this.registerMap),Object.values(this.registerMap.Devices).forEach((t,e)=>{this.mapComponent.devices[e]={name:t.Name,commSpec:{read:{startingRegiser:t.CommSpec[Object.keys(t.CommSpec)[0]].read["starting-register"],items:t.CommSpec[Object.keys(t.CommSpec)[0]].read.items}},valueUnit:t.ValueUnit},t.CommSpec[Object.keys(t.CommSpec)[0]].write!==void 0&&(this.mapComponent.devices[e].write={startingRegiser:t.CommSpec[Object.keys(t.CommSpec)[0]].write["starting-register"],items:t.CommSpec[Object.keys(t.CommSpec)[0]].write.items})})},simulateAction:function(){this.readResultShow=!1;var a=!0,t={};if(console.log(this.registerMap),this.registerMap.Class===void 0&&(console.log("this.selectedDeviceMap",this.selectedDeviceMap),this.selectDeviceMap(this.selectedDeviceMap)),t._id=this.modbusVariables._id,t.payload={unitid:this.modbusVariables._id,address:parseInt(this.modbusVariables.registerAddress,10)},this.command==="read"){if(this.modbusVariables._id<1||this.modbusVariables._id>247){b.value={icon:"report_problem",alert:!0,label:"\uC785\uB825\uC624\uB958",text:"\uC8FC\uC18C\uB294 1-247\uC0AC\uC774\uB85C \uC9C0\uC815\uD558\uC138\uC694",yesNo:!1},a=!1;return}if(parseInt(this.modbusVariables.registerValues,10)<1||parseInt(this.modbusVariables.registerValues,10)>100){b.value={icon:"report_problem",alert:!0,label:"\uC785\uB825\uC624\uB958",text:"\uC77D\uAE30 \uAC1C\uC218\uB294 1-100\uC0AC\uC774\uB85C \uB123\uC73C\uC138\uC694",yesNo:!1},a=!1;return}t.payload.fc=3,t.command="read",t.payload.quantity=parseInt(this.modbusVariables.registerValues,10)}else{if(this.modbusVariables._id<1||this.modbusVariables._id>247){b.value={icon:"report_problem",alert:!0,label:"\uC785\uB825\uC624\uB958",text:"\uC8FC\uC18C\uB294 1-247\uC0AC\uC774\uB85C \uC9C0\uC815\uD558\uC138\uC694",yesNo:!1},a=!1;return}console.log(this.modbusVariables.registerValues);var e=this.modbusVariables.registerValues.split(",");if(console.log(e),e.length>12){b.value={icon:"report_problem",alert:!0,label:"\uC785\uB825\uC624\uB958",text:"\uC4F0\uAE30\uB294 12\uAC1C \uC774\uD558\uB85C \uD558\uC138\uC694",yesNo:!1},a=!1;return}this.modbusVariables.functionCode===6?(t.command="write",t.payload.fc=6,t.payload.quantity=1,t.payload.value=parseInt(e[0])):(console.log(e.length),t.command="write",t.payload.fc=16,t.payload.quantity=e.length,t.payload.value=[],e.forEach(d=>{t.payload.value.push(parseInt(d))}))}setTimeout(()=>{a&&(t.topic="nodeDefault/requestModbus",console.log("data",t),C.send(t))},100)},readDeviceRegisterItemValues:function(a){if(console.log(this.mapComponent.devices[a]),this.mapComponent.readResultShow[a]){this.mapComponent.readResultShow[a]=!1;return}if(this.mapComponent.devices[a]!==void 0&&this.mapComponent.devices[a].showe)this.mapComponent.devices[a].show=!1;else{var t={_id:this.modbusVariables._id,index:a,command:"read",payload:{fc:3,unitid:this.modbusVariables._id,address:this.mapComponent.devices[a].commSpec.read.startingRegiser,quantity:this.countQuantity(this.mapComponent.devices[a].commSpec.read.items)}};console.log(modbus),t.topic="nodeDefault/readDeviceRegisterItemValues",C.send(t)}},valueToHex:function(a){return("0"+Number(a>>8&255).toString(16)).slice(-2)+("0"+Number(a&255).toString(16)).slice(-2)},calculateLength:function(a){var t=0;return a.forEach(e=>{t+=o.checkLength(e)}),t},byteToVal:function(a){var t=new ArrayBuffer(4),e=new DataView(t);return e.setUint8(0,a[1]>>8&255),e.setUint8(1,a[1]&255),e.setUint8(2,a[0]>>8&255),e.setUint8(3,a[0]&255),e},pushData:function(a,t,e,d,n){if(n===2)var r="0x"+this.valueToHex(e[1])+this.valueToHex(e[0]);else var r="0x"+this.valueToHex(e);return{address:a,description:t,hexValue:r,wordValue:d,registerCount:n}},checkLength:function(a){switch(String(a)){case"value":case"state-hold-time":case"remain-time":case"hold-time":case"time":case"EC":case"pH":case"epoch":case"vfloat":return 2;default:return 1}}}),O=(a,t)=>{var e=new XMLHttpRequest;e.overrideMimeType("application/json"),e.open("GET",a,!0),e.onreadystatechange=function(){e.readyState===4&&e.status=="200"&&t(e.responseText)},e.send(null)};return qe(()=>{console.log("ndoeConfig is mounted",C.isController),I.value=C.msg,C.send({topic:"nodeDefault/deviceCodes",collection:"deviceCodes",operation:"find.toArray"}),window.scrollTo(0,0)}),(a,t)=>(_(),L(U,null,[c(De,{modelValue:x(b).alert,"onUpdate:modelValue":t[1]||(t[1]=e=>x(b).alert=e),persistent:""},{default:u(()=>[c(Y,{style:{width:"300px"}},{default:u(()=>[c(J,{class:"row items-center"},{default:u(()=>[c(Z,{icon:x(b).icon,color:"primary","text-color":"white"},null,8,["icon"]),i("span",Ue,V(x(b).label),1)]),_:1}),c(J,{class:"q-pt-none"},{default:u(()=>[N(V(x(b).text),1)]),_:1}),x(b).yesNo?(_(),D(se,{key:0,align:"right"},{default:u(()=>[q(c(T,{class:"glossy",round:"",color:"deep-orange",label:"\uC608",style:{width:"60px"},onClick:t[0]||(t[0]=e=>x(b).onClick(x(b).param))},null,512),[[Q]]),q(c(T,{class:"glossy",round:"",color:"primary",label:"\uC544\uB2C8\uC624",style:{width:"60px"}},null,512),[[Q]])]),_:1})):(_(),D(se,{key:1,align:"right"},{default:u(()=>[q(c(T,{class:"glossy",round:"",color:"primary",label:"\uD655\uC778",style:{width:"60px"}},null,512),[[Q]])]),_:1}))]),_:1})]),_:1},8,["modelValue"]),$e,c(Y,null,{default:u(()=>[c(J,null,{default:u(()=>[i("div",ze,[i("div",Ge,[c(le,{dense:"",inline:"",options:[{label:"\uB178\uB4DC\uC77D\uAE30",value:"read"},{label:"\uB178\uB4DC\uC4F0\uAE30",value:"write"}],type:"radio",modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=e=>v.value=e)},null,8,["modelValue"])]),We,i("div",Ke,[c(le,{dense:"",inline:"",options:[{label:"\uC6D0\uC608\uC13C\uC11C",value:"defaultSensorNode"},{label:"\uCD95\uC0AC\uC13C\uC11C",value:"defaultLivestockSensorNode"},{label:"\uAD6C\uB3D9\uAE30",value:"defaultActuatorNode"}],type:"radio",modelValue:o.selectedDeviceMap,"onUpdate:modelValue":t[3]||(t[3]=e=>o.selectedDeviceMap=e),onInput:t[4]||(t[4]=e=>o.selectDeviceMap(a.selectedDeviceMap))},null,8,["modelValue"])])]),i("div",Xe,[Ye,Ze,i("div",Pe,[c(z,{outlined:"",dense:"",type:"text",placeholder:"",style:{width:"100%"},modelValue:o.modbusVariables._id,"onUpdate:modelValue":t[5]||(t[5]=e=>o.modbusVariables._id=e)},null,8,["modelValue"])])]),i("div",eo,[oo,to,i("div",ao,[v.value!=="write"?(_(),D(G,{key:0,color:"primary",label:"\uB808\uC9C0\uC2A4\uD130 \uC77D\uAE30"},{default:u(()=>[c($,null,{default:u(()=>[q((_(),D(A,{clickable:"",onClick:t[6]||(t[6]=e=>o.modbusVariables.functionCode=3)},{default:u(()=>[c(B,null,{default:u(()=>[c(H,null,{default:u(()=>[so]),_:1})]),_:1})]),_:1})),[[Q]])]),_:1})]),_:1})):(_(),D(G,{key:1,color:"primary",label:"\uB808\uC9C0\uC2A4\uD130 \uC4F0\uAE30"},{default:u(()=>[c($,null,{default:u(()=>[q((_(),D(A,{clickable:"",onClick:t[7]||(t[7]=e=>o.modbusVariables.functionCode=6)},{default:u(()=>[c(B,null,{default:u(()=>[c(H,null,{default:u(()=>[lo]),_:1})]),_:1})]),_:1})),[[Q]]),q((_(),D(A,{clickable:"",onClick:t[8]||(t[8]=e=>o.modbusVariables.functionCode=16)},{default:u(()=>[c(B,null,{default:u(()=>[c(H,null,{default:u(()=>[no]),_:1})]),_:1})]),_:1})),[[Q]])]),_:1})]),_:1}))]),i("div",io,V(o.modbusVariables.label),1),i("div",ro,[c(G,{color:"primary",label:"\uB9F5\uC120\uD0DD"},{default:u(()=>[c($,null,{default:u(()=>[(_(!0),L(U,null,te(Object.keys(o.registerMaps),e=>q((_(),D(A,{clickable:"",key:e,onClick:d=>o.selectDeviceMap(e)},{default:u(()=>[c(B,null,{default:u(()=>[c(H,null,{default:u(()=>[N(V(e),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[Q]])),128))]),_:1})]),_:1})])]),i("div",co,[uo,po,i("div",mo,[c(z,{outlined:"",dense:"",type:"text",placeholder:"",style:{width:"100%"},modelValue:o.modbusVariables.registerAddress,"onUpdate:modelValue":t[9]||(t[9]=e=>o.modbusVariables.registerAddress=e)},null,8,["modelValue"])])]),i("div",fo,[i("div",go,V(o.modbusVariables.actionMenu),1),vo,i("div",ho,[c(z,{outlined:"",dense:"",type:"text",placeholder:o.modbusVariables.placeHolder,style:{width:"100%"},modelValue:o.modbusVariables.registerValues,"onUpdate:modelValue":t[10]||(t[10]=e=>o.modbusVariables.registerValues=e)},null,8,["placeholder","modelValue"])])]),Co,i("div",bo,[c(T,{rounded:"",dense:"","text-color":"white",color:"primary",style:{width:"150px"},onClick:t[11]||(t[11]=e=>o.simulateAction())},{default:u(()=>[N(V(o.modbusVariables.action),1)]),_:1})])]),_:1})]),_:1}),q(i("div",yo,[c(Ae,null,{default:u(()=>[_o,i("tbody",null,[(_(!0),L(U,null,te(o.mapComponent.resultValues,(e,d)=>(_(),L("tr",{key:d},[i("th",ko,V(e.address),1),i("td",Vo,V(e.hexValue),1),i("td",Mo,V(e.wordValue),1),i("td",So,V(e.registerCount),1),i("td",wo,[e.address<=100||e.address>150?(_(),L("p",xo,V(e.description),1)):ae("",!0),e.address>100&&e.address<=150?(_(),D(T,{key:1,rounded:"",dense:"","text-color":"white",color:"primary",style:{width:"150px"},onClick:t[12]||(t[12]=n=>o.simulateAction())},{default:u(()=>[N(V(e.description),1)]),_:2},1024)):ae("",!0)]),i("td",null,[q(i("div",null,[i("pre",null,V(o.mapComponent.readResult[d]),1)],512),[[oe,o.mapComponent.readResultShow[d]]])])]))),128))])]),_:1})],512),[[oe,o.readResultShow]]),c(ve,{bordered:"",class:Ie(x(C).color[x(C).menuIndex].bg)},{default:u(()=>[c(Ne,null,{default:u(()=>[c(Oe,null,{default:u(()=>[c(Z,null,{default:u(()=>[qo]),_:1}),Do]),_:1})]),_:1})]),_:1},8,["class"])],64))}};export{To as default};
